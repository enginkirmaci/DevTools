<?xml version="1.0" encoding="utf-8" ?>
<Page
	x:Class="Tools.Views.Pages.NugetLocalPage"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	Background="Transparent"
	mc:Ignorable="d">

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<StackPanel Margin="0" Spacing="16">
			<!--  Control Center  -->
			<Border
				Padding="24"
				Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
				CornerRadius="8">
				<Grid ColumnSpacing="16">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="*" />
						<ColumnDefinition Width="Auto" />
						<ColumnDefinition Width="Auto" />
					</Grid.ColumnDefinitions>

					<StackPanel Spacing="16">
						<!--  Watch Folder Group  -->
						<StackPanel Spacing="8">
							<TextBlock
								FontSize="12"
								Foreground="{ThemeResource TextFillColorSecondaryBrush}"
								Opacity="0.7"
								Text="Watch Directory" />

							<Grid ColumnSpacing="8">
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="*" />
									<ColumnDefinition Width="Auto" />
									<ColumnDefinition Width="Auto" />
								</Grid.ColumnDefinitions>
								<TextBox VerticalAlignment="Center" Text="{x:Bind ViewModel.WatchFolder, Mode=TwoWay}" />
								<Button
									Grid.Column="1"
									Command="{x:Bind ViewModel.SelectFolderCommand}"
									CommandParameter="Watch">
									<FontIcon FontSize="16" Glyph="&#xE8B7;" />
								</Button>

								<Button
									Grid.Column="2"
									Command="{x:Bind ViewModel.RegisterSourceCommand}"
									Style="{StaticResource DefaultButtonStyle}"
									ToolTipService.ToolTip="Register this path in NuGet">
									<StackPanel Orientation="Horizontal" Spacing="8">
										<FontIcon FontSize="16" Glyph="&#xE78B;" />
										<TextBlock Text="Register" />
									</StackPanel>
								</Button>
							</Grid>
						</StackPanel>

						<!--  Global Cache Group  -->
						<StackPanel Orientation="Horizontal" Spacing="8">
							<TextBlock
								FontSize="12"
								Foreground="{ThemeResource TextFillColorSecondaryBrush}"
								Opacity="0.7"
								Text="Nuget Global Cache" />

							<TextBlock
								FontSize="12"
								Text="{x:Bind ViewModel.GlobalPackagesFolder, Mode=OneWay}"
								TextWrapping="Wrap" />
						</StackPanel>
					</StackPanel>

					<AppBarSeparator Grid.Column="1" />

					<!--  Action Buttons  -->
					<StackPanel Grid.Column="2" Spacing="8">
						<TextBlock
							FontSize="12"
							Foreground="{ThemeResource TextFillColorSecondaryBrush}"
							Opacity="0.7"
							Text="Operations" />

						<Button
							Width="120"
							Command="{x:Bind ViewModel.WatchChangesCommand}"
							CommandParameter="{StaticResource TrueValue}"
							Style="{StaticResource AccentButtonStyle}"
							Visibility="{x:Bind ViewModel.WatchStarted, Mode=OneWay, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
							<StackPanel Orientation="Horizontal" Spacing="12">
								<FontIcon FontSize="16" Glyph="&#xE768;" />
								<TextBlock
									HorizontalAlignment="Center"
									FontSize="16"
									Text="Start" />
							</StackPanel>
						</Button>

						<Button
							Width="120"
							Command="{x:Bind ViewModel.WatchChangesCommand}"
							CommandParameter="{StaticResource FalseValue}"
							Visibility="{x:Bind ViewModel.WatchStarted, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
							<StackPanel Orientation="Horizontal" Spacing="12">
								<FontIcon FontSize="16" Glyph="&#xE71A;" />
								<TextBlock
									HorizontalAlignment="Center"
									FontSize="16"
									Text="Stop" />
							</StackPanel>
						</Button>
					</StackPanel>
				</Grid>
			</Border>

			<!--  Stats and Info Grid  -->
			<Grid ColumnSpacing="16">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="*" />
					<ColumnDefinition Width="3*" />
				</Grid.ColumnDefinitions>

				<!--  Stats Card  -->
				<Border
					Padding="24"
					Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
					CornerRadius="8">
					<StackPanel Spacing="8">
						<TextBlock
							FontSize="14"
							FontWeight="SemiBold"
							Text="Session Activity" />
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto" />
								<ColumnDefinition Width="*" />
							</Grid.ColumnDefinitions>
							<FontIcon
								FontSize="36"
								Foreground="{ThemeResource SystemAccentColor}"
								Glyph="&#xE8F1;" />
							<StackPanel Grid.Column="1" Margin="16,0,0,0">
								<TextBlock
									FontSize="28"
									FontWeight="Bold"
									Text="{x:Bind ViewModel.Count, Mode=OneWay}" />
								<TextBlock
									FontSize="12"
									Foreground="{ThemeResource TextFillColorSecondaryBrush}"
									Text="Packages Refreshed" />
							</StackPanel>
						</Grid>
					</StackPanel>
				</Border>

				<!--  Simplified Info Section  -->
				<Border
					Grid.Column="1"
					Padding="24"
					Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
					CornerRadius="8">
					<StackPanel Spacing="12">
						<TextBlock
							FontSize="14"
							FontWeight="SemiBold"
							Text="How it works" />
						<TextBlock
							FontSize="12"
							Foreground="{ThemeResource TextFillColorSecondaryBrush}"
							Text="1. Register your build folder as a local NuGet source.&#x0a;2. Start Watch to monitor for new build outputs (.nupkg).&#x0a;3. On every build, the tool clears the global cache, forcing consumer projects to fetch your fresh DLLs."
							TextWrapping="Wrap" />
					</StackPanel>
				</Border>
			</Grid>
		</StackPanel>

		<!--  Modern Log Output Card  -->
		<Border
			Grid.Row="1"
			Margin="0,16"
			Padding="20,16"
			Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
			CornerRadius="8">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="*" />
				</Grid.RowDefinitions>
				<TextBlock
					Margin="0,0,0,8"
					FontWeight="SemiBold"
					Text="Activity Log" />
				<ScrollViewer
					Grid.Row="1"
					VerticalAlignment="Top"
					VerticalScrollBarVisibility="Auto">
					<ItemsRepeater ItemsSource="{x:Bind ViewModel.FileList, Mode=OneWay}">
						<ItemsRepeater.ItemTemplate>
							<DataTemplate x:DataType="x:String">
								<TextBlock
									Margin="0,2"
									FontFamily="Consolas"
									FontSize="12"
									Text="{Binding}"
									TextWrapping="Wrap" />
							</DataTemplate>
						</ItemsRepeater.ItemTemplate>
					</ItemsRepeater>
				</ScrollViewer>
			</Grid>
		</Border>
	</Grid>
</Page>