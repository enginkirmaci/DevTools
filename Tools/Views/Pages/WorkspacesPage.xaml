<?xml version="1.0" encoding="utf-8" ?>
<Page
	x:Class="Tools.Views.Pages.WorkspacesPage"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	Background="Transparent"
	mc:Ignorable="d">

	<Grid x:Name="RootGrid" DataContext="{x:Bind ViewModel}">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<!--  Filter and Refresh  -->
		<Border
			Grid.Row="0"
			Margin="0,0,0,12"
			Padding="20"
			Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
			BorderBrush="Transparent"
			BorderThickness="0"
			CornerRadius="8">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="*" />
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="Auto" />
				</Grid.ColumnDefinitions>

				<TextBox
					Grid.Column="0"
					Margin="0,0,12,0"
					PlaceholderText="Filter..."
					Text="{x:Bind ViewModel.FilterText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

				<Button
					Grid.Column="1"
					Width="44"
					Height="36"
					VerticalAlignment="Center"
					Command="{x:Bind ViewModel.RefreshCommand}"
					ToolTipService.ToolTip="Refresh workspaces">
					<FontIcon FontSize="16" Glyph="&#xE72C;" />
				</Button>

				<AppBarSeparator Grid.Column="2" Margin="8,0" />

				<Button
					Grid.Column="3"
					Width="44"
					Height="36"
					VerticalAlignment="Center"
					Command="{x:Bind ViewModel.OpenSettingsCommand}"
					ToolTipService.ToolTip="Workspace settings">
					<FontIcon FontSize="16" Glyph="&#xE713;" />
				</Button>
			</Grid>
		</Border>

		<ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>

				<!--  Platforms Header  -->
				<TextBlock
					Grid.Row="1"
					Margin="0,0,0,8"
					Style="{StaticResource SubtitleTextBlockStyle}"
					Visibility="{x:Bind ViewModel.FilteredPlatforms.Count, Mode=OneWay, Converter={StaticResource CountToVisibilityConverter}}">
					<Run Text="Platforms (" />
					<Run Text="{x:Bind ViewModel.FilteredPlatforms.Count, Mode=OneWay}" />
					<Run Text=")" />
				</TextBlock>

				<!--  Platforms List  -->
				<ItemsRepeater
					Grid.Row="2"
					Margin="0,0,0,24"
					ItemsSource="{x:Bind ViewModel.FilteredPlatforms, Mode=OneWay}"
					Visibility="{x:Bind ViewModel.FilteredPlatforms.Count, Mode=OneWay, Converter={StaticResource CountToVisibilityConverter}}">
					<ItemsRepeater.Layout>
						<UniformGridLayout
							MinColumnSpacing="8"
							MinItemHeight="80"
							MinItemWidth="410"
							MinRowSpacing="8" />
					</ItemsRepeater.Layout>
					<ItemsRepeater.ItemTemplate>
						<DataTemplate>
							<Border
								Padding="12"
								Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
								BorderBrush="Transparent"
								BorderThickness="2"
								CornerRadius="6">
								<Grid>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="*" />
										<ColumnDefinition Width="Auto" />
									</Grid.ColumnDefinitions>

									<StackPanel
										Grid.Column="0"
										Padding="6,0,0,0"
										VerticalAlignment="Center">
										<TextBlock
											FontSize="16"
											FontWeight="Medium"
											Text="{Binding PlatformName}"
											TextWrapping="Wrap" />
										<TextBlock
											Opacity="0.7"
											Style="{StaticResource CaptionTextBlockStyle}"
											Text="{Binding FolderPath}"
											TextWrapping="Wrap" />
									</StackPanel>

									<StackPanel
										Grid.Column="1"
										Height="32"
										VerticalAlignment="Top"
										Orientation="Horizontal"
										Spacing="4">
										<Button
											Padding="6"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenWithVSCodeCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="VS Code">
											<Image Source="/Assets/vscode.png" />
										</Button>
										<Button
											Padding="6"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenWithTerminalCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="Terminal">
											<Image Source="/Assets/terminal.png" />
										</Button>
										<Button
											Padding="6"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenFolderCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="Explorer">
											<Image Source="/Assets/folder.png" />
										</Button>
									</StackPanel>
								</Grid>
							</Border>
						</DataTemplate>
					</ItemsRepeater.ItemTemplate>
				</ItemsRepeater>

				<!--  Projects Header  -->

				<TextBlock
					Grid.Row="3"
					Margin="0,0,0,8"
					Style="{StaticResource SubtitleTextBlockStyle}">
					<Run Text="Projects (" />
					<Run Text="{x:Bind ViewModel.FilteredWorkspaces.Count, Mode=OneWay}" />
					<Run Text=")" />
				</TextBlock>

				<!--  Projects List  -->
				<ItemsRepeater Grid.Row="4" ItemsSource="{x:Bind ViewModel.FilteredWorkspaces, Mode=OneWay}">
					<ItemsRepeater.Layout>
						<UniformGridLayout
							MinColumnSpacing="8"
							MinItemHeight="80"
							MinItemWidth="410"
							MinRowSpacing="8" />
					</ItemsRepeater.Layout>
					<ItemsRepeater.ItemTemplate>
						<DataTemplate>
							<Border
								Padding="8"
								Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
								BorderBrush="Transparent"
								BorderThickness="2"
								CornerRadius="6">
								<Grid>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="*" />
										<ColumnDefinition Width="Auto" />
									</Grid.ColumnDefinitions>

									<StackPanel
										Grid.Column="0"
										Padding="6,0,0,0"
										VerticalAlignment="Center">
										<TextBlock
											FontSize="16"
											FontWeight="Medium"
											Text="{Binding SolutionName}"
											TextWrapping="Wrap" />
										<TextBlock
											Opacity="0.7"
											Style="{StaticResource CaptionTextBlockStyle}"
											Text="{Binding FolderPath}"
											TextWrapping="Wrap" />
									</StackPanel>

									<StackPanel
										Grid.Column="1"
										Height="32"
										VerticalAlignment="Top"
										Opacity="0.8"
										Orientation="Horizontal"
										Spacing="4">
										<Button
											Padding="6"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenSolutionCommand, ElementName=RootGrid}"
											CommandParameter="{Binding SolutionPath}"
											ToolTipService.ToolTip="Visual Studio">
											<Image Source="/Assets/vs.png" />
										</Button>
										<Button
											Padding="6"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenWithVSCodeCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="VS Code">
											<Image Source="/Assets/vscode.png" />
										</Button>
										<Button
											Padding="6"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenWithTerminalCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="Terminal">
											<Image Source="/Assets/terminal.png" />
										</Button>
										<Button
											Padding="6"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenFolderCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="Explorer">
											<Image Source="/Assets/folder.png" />
										</Button>
									</StackPanel>
								</Grid>
							</Border>
						</DataTemplate>
					</ItemsRepeater.ItemTemplate>
				</ItemsRepeater>
			</Grid>
		</ScrollViewer>
	</Grid>
</Page>