<?xml version="1.0" encoding="utf-8" ?>
<Page
	x:Class="Tools.Views.Pages.WorkspacesPage"
	xmlns:conv="using:Tools.Library.Converters"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	Background="Transparent"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	mc:Ignorable="d">

	<Grid x:Name="RootGrid" DataContext="{x:Bind ViewModel}">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<!--  Filter and Refresh  -->
		<Grid Grid.Row="0" Margin="0,0,0,18">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*" />
				<ColumnDefinition Width="Auto" />
			</Grid.ColumnDefinitions>

			<TextBox
				Grid.Column="0"
				Margin="0,0,8,0"
				PlaceholderText="Filter..."
				Text="{x:Bind ViewModel.FilterText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

			<Button
				Grid.Column="1"
				Command="{x:Bind ViewModel.RefreshCommand}"
				ToolTipService.ToolTip="Refresh workspaces">
				<FontIcon FontSize="16" Glyph="&#xE72C;" />
			</Button>
		</Grid>

		<ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>

				<!--  Platforms Header  -->
				<TextBlock
					Grid.Row="1"
					Margin="0,0,0,8"
					FontSize="20"
					Visibility="{x:Bind ViewModel.FilteredPlatforms.Count, Mode=OneWay, Converter={StaticResource CountToVisibilityConverter}}">
					<Run Text="Platforms (" />
					<Run Text="{x:Bind ViewModel.FilteredPlatforms.Count, Mode=OneWay}" />
					<Run Text=")" />
				</TextBlock>

				<!--  Platforms List  -->
				<ItemsRepeater
					Grid.Row="2"
					Margin="0,0,0,24"
					ItemsSource="{x:Bind ViewModel.FilteredPlatforms, Mode=OneWay}">
					<ItemsRepeater.Layout>
						<UniformGridLayout
							MinColumnSpacing="8"
							MinItemHeight="100"
							MinItemWidth="414"
							MinRowSpacing="8" />
					</ItemsRepeater.Layout>
					<ItemsRepeater.ItemTemplate>
						<DataTemplate>
							<Border
								Padding="12"
								Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
								BorderBrush="Transparent"
								BorderThickness="2"
								CornerRadius="6">
								<Grid>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="*" />
										<ColumnDefinition Width="Auto" />
									</Grid.ColumnDefinitions>

									<StackPanel
										Grid.Column="0"
										Padding="6,0,0,0"
										VerticalAlignment="Center">
										<TextBlock
											FontWeight="SemiBold"
											Text="{Binding PlatformName}"
											TextWrapping="Wrap" />
										<TextBlock
											Opacity="0.7"
											Style="{StaticResource CaptionTextBlockStyle}"
											Text="{Binding FolderPath}"
											TextWrapping="Wrap" />
									</StackPanel>

									<VariableSizedWrapGrid
										Grid.Column="1"
										Height="80"
										VerticalAlignment="Center">
										<Button
											Width="42"
											Height="32"
											Margin="4"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenWithVSCodeCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="VS Code">
											<FontIcon FontSize="16" Glyph="&#xE943;" />
										</Button>
										<Button
											Width="42"
											Height="32"
											Margin="4"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenWithTerminalCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="Terminal">
											<FontIcon FontSize="16" Glyph="&#xE756;" />
										</Button>
										<Button
											Width="42"
											Height="32"
											Margin="4"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenFolderCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="Explorer">
											<FontIcon FontSize="16" Glyph="&#xE838;" />
										</Button>
									</VariableSizedWrapGrid>
								</Grid>
							</Border>
						</DataTemplate>
					</ItemsRepeater.ItemTemplate>
				</ItemsRepeater>

				<!--  Projects Header  -->
				<TextBlock
					Grid.Row="3"
					Margin="0,0,0,8"
					FontSize="20">
					<Run Text="Projects (" />
					<Run Text="{x:Bind ViewModel.FilteredWorkspaces.Count, Mode=OneWay}" />
					<Run Text=")" />
				</TextBlock>

				<!--  Projects List  -->
				<ItemsRepeater Grid.Row="4" ItemsSource="{x:Bind ViewModel.FilteredWorkspaces, Mode=OneWay}">
					<ItemsRepeater.Layout>
						<UniformGridLayout
							MinColumnSpacing="8"
							MinItemHeight="100"
							MinItemWidth="414"
							MinRowSpacing="8" />
					</ItemsRepeater.Layout>
					<ItemsRepeater.ItemTemplate>
						<DataTemplate>
							<Border
								Padding="12"
								Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
								BorderBrush="Transparent"
								BorderThickness="2"
								CornerRadius="6">
								<Grid>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="*" />
										<ColumnDefinition Width="Auto" />
									</Grid.ColumnDefinitions>

									<StackPanel
										Grid.Column="0"
										Padding="6,0,0,0"
										VerticalAlignment="Center">
										<TextBlock
											FontWeight="SemiBold"
											Text="{Binding SolutionName}"
											TextWrapping="Wrap" />
										<TextBlock
											Opacity="0.7"
											Style="{StaticResource CaptionTextBlockStyle}"
											Text="{Binding FolderPath}"
											TextWrapping="Wrap" />
									</StackPanel>

									<VariableSizedWrapGrid
										Grid.Column="1"
										Height="80"
										VerticalAlignment="Center">
										<Button
											Width="42"
											Height="32"
											Margin="4"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenSolutionCommand, ElementName=RootGrid}"
											CommandParameter="{Binding SolutionPath}"
											ToolTipService.ToolTip="Visual Studio">
											<FontIcon FontSize="16" Glyph="&#xE8A7;" />
										</Button>
										<Button
											Width="42"
											Height="32"
											Margin="4"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenWithTerminalCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="Terminal">
											<FontIcon FontSize="16" Glyph="&#xE756;" />
										</Button>
										<Button
											Width="42"
											Height="32"
											Margin="4"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenWithVSCodeCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="VS Code">
											<FontIcon FontSize="16" Glyph="&#xE943;" />
										</Button>
										<Button
											Width="42"
											Height="32"
											Margin="4"
											Background="Transparent"
											BorderBrush="Transparent"
											Command="{Binding DataContext.OpenFolderCommand, ElementName=RootGrid}"
											CommandParameter="{Binding FolderPath}"
											ToolTipService.ToolTip="Explorer">
											<FontIcon FontSize="16" Glyph="&#xE838;" />
										</Button>
									</VariableSizedWrapGrid>
								</Grid>
							</Border>
						</DataTemplate>
					</ItemsRepeater.ItemTemplate>
				</ItemsRepeater>
			</Grid>
		</ScrollViewer>
	</Grid>
</Page>