<Window
	x:Class="Tools.Views.Windows.TimerNotificationWindow"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	Title="Focus Timer"
	mc:Ignorable="d">

	<Border
		Background="{ThemeResource LayerFillColorDefaultBrush}"
		BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
		BorderThickness="1"
		CornerRadius="16">
		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="32" />
				<RowDefinition Height="*" />
			</Grid.RowDefinitions>

			<!--  Custom Title Bar  -->
			<Grid
				x:Name="CustomTitleBar"
				Grid.Row="0"
				Padding="16,0,8,0"
				Background="Transparent">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="*" />
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="Auto" />
				</Grid.ColumnDefinitions>

				<Button
					x:Name="PinButton"
					Grid.Column="1"
					Width="36"
					Height="36"
					Margin="0,0,4,0"
					Background="Transparent"
					BorderThickness="0"
					Click="OnPinToggle"
					ToolTipService.ToolTip="Pin window">
					<FontIcon x:Name="PinIcon" FontSize="12" />
				</Button>

				<Button
					x:Name="CloseButton"
					Grid.Column="2"
					Width="36"
					Height="36"
					Background="Transparent"
					BorderThickness="0"
					Click="OnCloseClick"
					ToolTipService.ToolTip="Hide">
					<FontIcon FontSize="12" Glyph="&#xE711;" />
				</Button>
			</Grid>

			<!--  Main Content  -->
			<Grid Grid.Row="1" Padding="28,8,28,28">
				<Grid.ChildrenTransitions>
					<TransitionCollection>
						<EntranceThemeTransition FromVerticalOffset="20" />
					</TransitionCollection>
				</Grid.ChildrenTransitions>

				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>

				<Expander
					Grid.RowSpan="3"
					Margin="0,16,0,0"
					HorizontalAlignment="Right"
					VerticalAlignment="Bottom"
					ExpandDirection="Up"
					IsExpanded="False">
					<Expander.Header>
						<FontIcon
							VerticalAlignment="Center"
							FontSize="16"
							Glyph="&#xE9D2;" />
					</Expander.Header>
					<StackPanel Orientation="Vertical">
						<StackPanel
							HorizontalAlignment="Center"
							Orientation="Horizontal"
							Spacing="8">
							<FontIcon
								VerticalAlignment="Center"
								FontSize="14"
								Glyph="&#xE823;"
								Opacity="0.5" />
							<TextBlock
								FontSize="14"
								FontWeight="Medium"
								Foreground="{ThemeResource TextFillColorPrimaryBrush}"
								Text="{x:Bind ViewModel.WorkDayCountdown, Mode=OneWay}" />
						</StackPanel>

						<StackPanel
							HorizontalAlignment="Center"
							Orientation="Horizontal"
							Spacing="8">
							<FontIcon
								VerticalAlignment="Center"
								FontSize="14"
								Glyph="&#xE821;"
								Opacity="0.5" />
							<TextBlock
								FontSize="14"
								FontWeight="Medium"
								Foreground="{ThemeResource TextFillColorPrimaryBrush}"
								Text="{x:Bind ViewModel.BreakIntervalDisplay, Mode=OneWay}" />
						</StackPanel>

						<StackPanel Orientation="Horizontal" Spacing="6">
							<FontIcon
								VerticalAlignment="Center"
								FontSize="12"
								Glyph="&#xEC32;" />
							<TextBlock
								Margin="0,0,0,10"
								VerticalAlignment="Center"
								FontSize="12"
								FontWeight="Medium"
								Foreground="{ThemeResource TextFillColorSecondaryBrush}"
								Text="{x:Bind ViewModel.BreakBankStatus, Mode=OneWay}" />
						</StackPanel>
					</StackPanel>
				</Expander>

				<!--  Timer Section  -->
				<Grid
					Grid.Row="0"
					Margin="0,16,0,32"
					HorizontalAlignment="Center">
					<!--  Background Ring  -->
					<ProgressRing
						Width="160"
						Height="160"
						Foreground="{x:Bind ViewModel.ProgressRingBrush, Mode=OneWay}"
						IsIndeterminate="False"
						Maximum="100"
						Value="{x:Bind ViewModel.SessionProgress, Mode=OneWay}" />

					<StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
						<TextBlock
							Margin="0,0,0,-6"
							HorizontalAlignment="Center"
							FontSize="48"
							FontWeight="Bold"
							Text="{x:Bind ViewModel.CountdownDisplay, Mode=OneWay}" />
						<TextBlock
							HorizontalAlignment="Center"
							CharacterSpacing="50"
							FontSize="12"
							FontWeight="SemiBold"
							Foreground="{ThemeResource TextFillColorSecondaryBrush}"
							Opacity="0.8"
							Text="{x:Bind ViewModel.StatusMessage, Mode=OneWay}" />
					</StackPanel>
				</Grid>

				<!--  Action Buttons Container  -->
				<Grid Grid.Row="1" Margin="0,16,0,0">
					<!--  Stopped State  -->
					<Button
						x:Name="StoppedButtons"
						Height="48"
						HorizontalAlignment="Stretch"
						Command="{x:Bind ViewModel.StartTimerCommand}"
						CornerRadius="12"
						Style="{StaticResource AccentButtonStyle}"
						Visibility="Visible">
						<StackPanel Orientation="Horizontal" Spacing="12">
							<FontIcon FontSize="18" Glyph="&#xE768;" />
							<TextBlock
								FontSize="15"
								FontWeight="SemiBold"
								Text="Start Focus" />
						</StackPanel>
					</Button>

					<!--  Working State  -->
					<Grid
						x:Name="WorkingButtons"
						ColumnDefinitions="*, Auto"
						Visibility="Collapsed">
						<Button
							Grid.Column="0"
							Height="48"
							Margin="0,0,10,0"
							HorizontalAlignment="Stretch"
							Command="{x:Bind ViewModel.TakeBreakNowCommand}"
							CornerRadius="12"
							Style="{StaticResource AccentButtonStyle}">
							<StackPanel Orientation="Horizontal" Spacing="10">
								<FontIcon FontSize="18" Glyph="&#xE7F8;" />
								<TextBlock
									FontSize="15"
									FontWeight="SemiBold"
									Text="Take Break" />
							</StackPanel>
						</Button>
						<Button
							Grid.Column="1"
							Height="48"
							Command="{x:Bind ViewModel.StopTimerCommand}"
							CornerRadius="12"
							ToolTipService.ToolTip="Stop Session">
							<StackPanel Orientation="Horizontal" Spacing="10">
								<FontIcon FontSize="18" Glyph="&#xE71A;" />
								<TextBlock
									FontSize="15"
									FontWeight="SemiBold"
									Text="Stop" />
							</StackPanel>
						</Button>
					</Grid>

					<!--  Notification State  -->
					<Grid
						x:Name="NotificationButtons"
						ColumnDefinitions="*, Auto"
						Visibility="Collapsed">
						<Button
							Grid.Column="0"
							Height="48"
							Margin="0,0,10,0"
							HorizontalAlignment="Stretch"
							Command="{x:Bind ViewModel.TakeBreakCommand}"
							CornerRadius="12"
							Style="{StaticResource AccentButtonStyle}">
							<StackPanel Orientation="Horizontal" Spacing="10">
								<FontIcon FontSize="18" Glyph="&#xE7F8;" />
								<TextBlock
									FontSize="15"
									FontWeight="SemiBold"
									Text="Break Now" />
							</StackPanel>
						</Button>
						<Button
							Grid.Column="1"
							Width="80"
							Height="48"
							Command="{x:Bind ViewModel.SnoozeBreakCommand}"
							CornerRadius="12">
							<StackPanel Orientation="Horizontal" Spacing="8">
								<FontIcon FontSize="16" Glyph="&#xED4C;" />
								<TextBlock
									FontSize="15"
									FontWeight="SemiBold"
									Text="5m" />
							</StackPanel>
						</Button>
					</Grid>

					<!--  Break Active State  -->
					<Button
						x:Name="BreakActiveButtons"
						Height="48"
						HorizontalAlignment="Stretch"
						Command="{x:Bind ViewModel.EndBreakEarlyCommand}"
						CornerRadius="12"
						Style="{StaticResource AccentButtonStyle}"
						Visibility="Collapsed">
						<StackPanel Orientation="Horizontal" Spacing="12">
							<FontIcon FontSize="18" Glyph="&#xE72A;" />
							<TextBlock
								FontSize="15"
								FontWeight="SemiBold"
								Text="Resume Work" />
						</StackPanel>
					</Button>
				</Grid>

				<Grid Grid.Row="2" Margin="0,16,0,0">
					<FontIcon
						VerticalAlignment="Center"
						FontSize="12"
						Glyph="&#xEC32;" />
					<ProgressBar
						Grid.Row="1"
						Height="6"
						VerticalAlignment="Center"
						CornerRadius="3"
						Maximum="100"
						Value="{x:Bind ViewModel.BreakBankPercentage, Mode=OneWay}" />
				</Grid>
			</Grid>
		</Grid>
	</Border>
</Window>