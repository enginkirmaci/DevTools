<Window
    x:Class="Tools.Views.Windows.TimerNotificationWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="Focus Timer"
    mc:Ignorable="d">

    <Border
        Background="{ThemeResource LayerFillColorDefaultBrush}"
        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
        BorderThickness="1"
        CornerRadius="12">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40" />
                <!--  Custom Title Bar  -->
                <RowDefinition Height="*" />
                <!--  Main Content  -->
            </Grid.RowDefinitions>

            <!--  Custom Title Bar  -->
            <Grid
                x:Name="CustomTitleBar"
                Grid.Row="0"
                Padding="12,0"
                Background="Transparent">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!--  Drag Region (Title)  -->
                <TextBlock
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    FontSize="12"
                    FontWeight="SemiBold"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                    Text="Focus Timer" />

                <!--  Pin Button  -->
                <Button
                    x:Name="PinButton"
                    Grid.Column="1"
                    Width="36"
                    Height="36"
                    Margin="0,0,4,0"
                    Background="Transparent"
                    BorderThickness="0"
                    Click="OnPinToggle"
                    ToolTipService.ToolTip="Pin window always on top">
                    <FontIcon x:Name="PinIcon" FontSize="12" />
                </Button>

                <!--  Close Button  -->
                <Button
                    x:Name="CloseButton"
                    Grid.Column="2"
                    Width="36"
                    Height="36"
                    Background="Transparent"
                    BorderThickness="0"
                    Click="OnCloseClick"
                    ToolTipService.ToolTip="Hide window">
                    <FontIcon FontSize="12" Glyph="&#xE711;" />
                </Button>
            </Grid>

            <!--  Main Content  -->
            <Grid Grid.Row="1" Padding="20,12,20,20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <!--  Progress Ring Area  -->
                    <RowDefinition Height="Auto" />
                    <!--  Work Day Info  -->
                    <RowDefinition Height="Auto" />
                    <!--  Break Interval Info  -->
                    <RowDefinition Height="Auto" />
                    <!--  Break Bank  -->
                    <RowDefinition Height="Auto" />
                    <!--  Action Buttons  -->
                    <RowDefinition Height="*" />
                    <!--  Settings Link  -->
                </Grid.RowDefinitions>

                <!--  Progress Ring with Overlay Text  -->
                <Grid
                    Grid.Row="0"
                    Margin="0,8,0,16"
                    HorizontalAlignment="Center">
                    <ProgressRing
                        Width="140"
                        Height="140"
                        Foreground="{x:Bind ViewModel.ProgressRingBrush, Mode=OneWay}"
                        IsIndeterminate="False"
                        Maximum="{x:Bind ViewModel.SessionProgressMax, Mode=OneWay}"
                        Value="{x:Bind ViewModel.SessionProgress, Mode=OneWay}" />

                    <!--  Countdown Display Inside Ring  -->
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontSize="32"
                            FontWeight="Bold"
                            Text="{x:Bind ViewModel.CountdownDisplay, Mode=OneWay}" />
                        <TextBlock
                            Margin="0,2,0,0"
                            HorizontalAlignment="Center"
                            FontSize="11"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="{x:Bind ViewModel.StatusMessage, Mode=OneWay}" />
                    </StackPanel>
                </Grid>

                <!--  Work Day Countdown  -->
                <TextBlock
                    Grid.Row="1"
                    Margin="0,0,0,8"
                    HorizontalAlignment="Center"
                    FontSize="13"
                    Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                    Text="{x:Bind ViewModel.WorkDayCountdown, Mode=OneWay}" />

                <!--  Break Interval Info  -->
                <TextBlock
                    Grid.Row="2"
                    Margin="0,0,0,12"
                    HorizontalAlignment="Center"
                    FontSize="12"
                    Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                    Text="{x:Bind ViewModel.BreakIntervalDisplay, Mode=OneWay}" />

                <!--  Break Bank Indicator  -->
                <Grid Grid.Row="3" Margin="0,0,0,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <TextBlock
                        Grid.Row="0"
                        Margin="0,0,0,4"
                        HorizontalAlignment="Center"
                        FontSize="11"
                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                        Text="{x:Bind ViewModel.BreakBankStatus, Mode=OneWay}" />
                    <ProgressBar
                        Grid.Row="1"
                        Height="6"
                        CornerRadius="3"
                        Maximum="100"
                        Value="{x:Bind ViewModel.BreakBankPercentage, Mode=OneWay}" />
                </Grid>

                <!--  Action Buttons - Stopped State  -->
                <StackPanel
                    x:Name="StoppedButtons"
                    Grid.Row="4"
                    HorizontalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="8"
                    Visibility="Visible">
                    <Button
                        Padding="20,10"
                        Command="{x:Bind ViewModel.StartTimerCommand}"
                        Style="{StaticResource AccentButtonStyle}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon FontSize="14" Glyph="&#xE768;" />
                            <TextBlock Text="Start" />
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!--  Action Buttons - Working State  -->
                <StackPanel
                    x:Name="WorkingButtons"
                    Grid.Row="4"
                    HorizontalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="8"
                    Visibility="Collapsed">
                    <Button
                        Padding="16,8"
                        Command="{x:Bind ViewModel.TakeBreakNowCommand}"
                        Style="{StaticResource AccentButtonStyle}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon FontSize="14" Glyph="&#xE7F8;" />
                            <TextBlock Text="Take Break" />
                        </StackPanel>
                    </Button>
                    <Button Padding="16,8" Command="{x:Bind ViewModel.StopTimerCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon FontSize="14" Glyph="&#xE71A;" />
                            <TextBlock Text="Stop" />
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!--  Action Buttons - Notification State  -->
                <StackPanel
                    x:Name="NotificationButtons"
                    Grid.Row="4"
                    HorizontalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="8"
                    Visibility="Collapsed">
                    <Button
                        Padding="16,8"
                        Command="{x:Bind ViewModel.TakeBreakCommand}"
                        Style="{StaticResource AccentButtonStyle}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon FontSize="14" Glyph="&#xE7F8;" />
                            <TextBlock Text="Take Break" />
                        </StackPanel>
                    </Button>
                    <Button
                        Padding="12,8"
                        Command="{x:Bind ViewModel.SnoozeBreakCommand}"
                        ToolTipService.ToolTip="Snooze for 5 minutes">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <FontIcon FontSize="14" Glyph="&#xED4C;" />
                            <TextBlock Text="5m" />
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!--  Action Buttons - Break Active State  -->
                <StackPanel
                    x:Name="BreakActiveButtons"
                    Grid.Row="4"
                    HorizontalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="8"
                    Visibility="Collapsed">
                    <Button
                        Padding="20,10"
                        Command="{x:Bind ViewModel.EndBreakEarlyCommand}"
                        Style="{StaticResource AccentButtonStyle}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon FontSize="14" Glyph="&#xE72A;" />
                            <TextBlock Text="Resume Work" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>